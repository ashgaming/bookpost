"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[640],{1784:(e,t,a)=>{a.d(t,{c:()=>r});a(9060);var o=a(1560),c=a(2496);const r=e=>{let{url:t}=e;const a=(0,o.i6)();return(0,c.jsx)("div",{className:"w-full flex justify-start my-5",children:(0,c.jsx)("button",{className:"bg-customOrange text-white py-2 px-4 rounded hover:bg-hoverOrange transition-colors duration-200",onClick:()=>{a(t)},children:"Go Back"})})}},2432:(e,t,a)=>{a.d(t,{c:()=>c});a(9060);var o=a(2496);const c=()=>(0,o.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-75 z-50",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-32 w-32 mb-4"}),(0,o.jsx)("h2",{className:"text-white text-xl font-semibold",children:"Loading..."}),(0,o.jsx)("p",{className:"text-white text-sm mt-2",children:"Please wait"})]})})},9072:(e,t,a)=>{a.d(t,{c:()=>c});a(9060);var o=a(2496);const c=e=>{let{children:t}=e;return(0,o.jsx)("div",{children:t})}},9840:(e,t,a)=>{a.d(t,{e:()=>r});var o=a(9780),c=a(8524);const r=async e=>{const t=new FormData;t.append("image",e);const a=localStorage.getItem("token"),r={headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(a)},withCredentials:!0};try{const e=await o.c.post("".concat(c.M,"/api/upload-image/"),t,r);return console.log(e.data),e.data.image_url}catch(l){throw alert("Error uploading image:",l),new Error("Image upload failed")}}},6776:(e,t,a)=>{a.d(t,{Cg:()=>h,Ub:()=>g,Wh:()=>u,YH:()=>v,e6:()=>i,ew:()=>x,gn:()=>m,m8:()=>d,my:()=>p,yU:()=>y});var o=a(9780),c=a(4348),r=a(8524);const l=localStorage.getItem("token")?localStorage.getItem("token"):null,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(l)},withCredentials:!0},s={headers:{"Content-type":"application/json"}},i=e=>async t=>{try{t({type:c.S});const{data:a}=await o.c.post("".concat(r.M,"/api/story/create/"),e,n);t({type:c.eY,payload:a})}catch(a){t({type:c.gf,payload:a})}},d=()=>async e=>{try{e({type:c.S_});const t=localStorage.getItem("token")?localStorage.getItem("token"):null,a={headers:{"Content-type":"application/json",...t&&{Authorization:"Bearer ".concat(t)}},withCredentials:!0},{data:l}=await o.c.get("".concat(r.M,"/api/story/list"),a);e({type:c.gr,payload:l})}catch(t){e({type:c.cW,payload:t})}},p=e=>async t=>{try{t({type:c.wp});const{data:a}=await o.c.get("".concat(r.M,"/api/story/").concat(e),s);t({type:c.sT,payload:a})}catch(a){t({type:c.Sw,payload:a})}},y=(e,t)=>async a=>{try{a({type:c.SY});const{data:l}=await o.c.post("".concat(r.M,"/api/story/").concat(e,"/chapter/create/"),t,n);a({type:c.wb,payload:l})}catch(l){a({type:c.ol,payload:l})}},u=e=>async t=>{try{t({type:c.UJ});const{data:a}=await o.c.get("".concat(r.M,"/api/story/").concat(e,"/chapter/list"),s);t({type:c.i3,payload:a})}catch(a){t({type:c.U6,payload:a})}},h=(e,t)=>async a=>{try{a({type:c.Ws});const{data:l}=await o.c.get("".concat(r.M,"/api/story/").concat(e,"/chapter/").concat(t),s);a({type:c.Mn,payload:l})}catch(l){a({type:c.WG,payload:l})}},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return async t=>{try{t({type:c.Ah});const{data:a}=await o.c.get("".concat(r.M,"/api/admin/story/list").concat(e?"?page=".concat(e):""),n);t({type:c.I1,payload:a})}catch(a){t({type:c.S6,payload:a})}}},x=e=>async t=>{try{t({type:c.cX});const{data:a}=await o.c.get("".concat(r.M,"/api/admin/story/").concat(e,"/chapter/list"),n);t({type:c._I,payload:a})}catch(a){t({type:c.kf,payload:a})}},v=(e,t,a)=>async l=>{try{console.log(a),l({type:c.aA});const{data:s}=await o.c.put("".concat(r.M,"/api/story/").concat(e,"/chapter/").concat(t,"/update"),a,n);l({type:c.IT,payload:s})}catch(s){l({type:c.We,payload:s})}},g=(e,t)=>async a=>{try{a({type:c.m8});const{data:l}=await o.c.put("".concat(r.M,"/api/story/").concat(e,"/update"),t,n);a({type:c.Ip,payload:l})}catch(l){a({type:c.An,payload:l})}}},6640:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var o=a(9060),c=a(624),r=a(1560),l=a(9840),n=a(6776),s=a(3120),i=a(9072),d=a(2432),p=a(4348),y=a(1784),u=a(2496);const h=e=>{let{dispatch:t}=e;const{storyid:a}=(0,r.W4)(),[h,m]=(0,o.useState)(""),[x,v]=(0,o.useState)(!1),g=(0,c.w1)((e=>e.readStory)),{loading:j,error:f,book:w}=g,b=(0,c.w1)((e=>e.updateStory)),{loading:S,error:N,success:C}=b,M=(0,o.useRef)(null),k=(0,o.useRef)(null),A=(0,o.useRef)(null),F=(0,r.i6)(),[I,T]=(0,o.useState)({}),[R,U]=(0,o.useState)(!1),[W,_]=(0,o.useState)(null);(0,o.useEffect)((()=>{w&&(null===w||void 0===w?void 0:w._id)==a||t((0,n.my)(a)),console.log(w);w&&(null===w||void 0===w?void 0:w._id)==a&&!x&&((async()=>{w&&(null===w||void 0===w?void 0:w._id)==a&&!x&&(M.current.value=w.name||"",A.current.value=w.category||"",k.current.value=w.summary||"",m(w.cover||"")),v(!0)})(),T({title:w.title,category:A.current.value,summary:k.current.value,cover:w.cover}),m(w.cover))}),[t,a,x,w]);(0,o.useEffect)((()=>{C&&(alert("Story Updated ..."),F("/list-story",{replace:!0}),t({type:p.yK}),t({type:p.AH}))}),[C]);return j?(0,u.jsx)(s.c,{}):f?(0,u.jsx)(i.c,{children:f}):null!==w&&void 0!==w&&w._id?(0,u.jsxs)("form",{onSubmit:e=>{e.preventDefault();const o={};M.current.value!==I.title&&(o.title=M.current.value),A.current.value!==I.category&&(o.category=A.current.value),k.current.value!==I.summary&&(o.summary=k.current.value),h!==I.cover&&(console.log("image",h),console.log("old img",I.image),o.cover=h),t((0,n.Ub)(a,o))},className:"form bg-white p-6 my-10 relative max-w-lg mx-auto shadow-lg rounded-lg",children:[(0,u.jsx)(y.c,{url:"/list-story"}),S&&(0,u.jsx)(d.c,{}),(0,u.jsx)("h3",{className:"text-2xl text-gray-900 font-semibold",children:"Edit Story"}),N&&(0,u.jsx)(i.c,{children:N}),(0,u.jsx)("div",{className:"flex space-x-5 mt-3",children:(0,u.jsx)("input",{type:"text",placeholder:"Title",className:"border p-2 w-1/2",ref:M})}),(0,u.jsx)("div",{className:"flex space-x-5 mt-3 mb-2",children:(0,u.jsxs)("select",{name:"category",ref:A,className:"border p-2 rounded-md",children:[(0,u.jsx)("option",{value:"Fantasy",children:"Fantasy"}),(0,u.jsx)("option",{value:"Adventure",children:"Adventure"}),(0,u.jsx)("option",{value:"Fairy Tale",children:"Fairy Tales"}),(0,u.jsx)("option",{value:"Mystery",children:"Mystery"}),(0,u.jsx)("option",{value:"Science Fiction",children:"Science Fiction"}),(0,u.jsx)("option",{value:"Historical Fiction",children:"Historical Fiction"}),(0,u.jsx)("option",{value:"Horror",children:"Horror"}),(0,u.jsx)("option",{value:"Romance",children:"Romance"}),(0,u.jsx)("option",{value:"Rom-Com",children:"Rom-Com"}),(0,u.jsx)("option",{value:"Drama",children:"Drama"}),(0,u.jsx)("option",{value:"Thriller",children:"Thriller"}),(0,u.jsx)("option",{value:"Non Fiction",children:"Non-Fiction"}),(0,u.jsx)("option",{value:"Biography",children:"Biography"}),(0,u.jsx)("option",{value:"Comedy",children:"Comedy"}),(0,u.jsx)("option",{value:"Classic",children:"Classic"}),(0,u.jsx)("option",{value:"Young Adult",children:"Young Adult"}),(0,u.jsx)("option",{value:"Children",children:"Children's"}),(0,u.jsx)("option",{value:"Graphic Novel",children:"Graphic Novel"})]})}),(0,u.jsx)("div",{className:"relative max-h-52 aspect-[9/16] bg-gray-200 overflow-hidden left-1/3 align-middle",children:(0,u.jsx)("img",{src:h,alt:"",className:"object-cover w-full h-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})}),R&&(0,u.jsx)(s.c,{}),W&&(0,u.jsx)(i.c,{children:W}),(0,u.jsx)("div",{className:"flex space-x-5 mt-3",children:(0,u.jsx)("input",{type:"file",onChange:async e=>{e.preventDefault(),U(!0);const t=e.target.files[0];if(t)try{const e=await(0,l.e)(t);m(e)}catch(f){_(f)}U(!1)},className:"border p-2 w-1/2",accept:"image/*"})}),(0,u.jsx)("h1",{children:"Summary"}),(0,u.jsx)("textarea",{placeholder:"Write Summary here",className:"border p-2 mt-3 w-full",ref:k,maxLength:2e3}),(0,u.jsx)("input",{type:"submit",value:"Update Story",className:"w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white font-semibold p-3"})]}):null}}}]);
//# sourceMappingURL=640.5e7281e0.chunk.js.map