"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[536],{1784:(t,e,a)=>{a.d(e,{c:()=>o});a(9060);var c=a(1560),r=a(2496);const o=t=>{let{url:e}=t;const a=(0,c.i6)();return(0,r.jsx)("div",{className:"w-full flex justify-start my-5",children:(0,r.jsx)("button",{className:"bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors duration-200",onClick:()=>{a(e)},children:"Go Back"})})}},2432:(t,e,a)=>{a.d(e,{c:()=>r});a(9060);var c=a(2496);const r=()=>(0,c.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-75 z-50",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-32 w-32 mb-4"}),(0,c.jsx)("h2",{className:"text-white text-xl font-semibold",children:"Loading..."}),(0,c.jsx)("p",{className:"text-white text-sm mt-2",children:"Please wait"})]})})},9072:(t,e,a)=>{a.d(e,{c:()=>r});a(9060);var c=a(2496);const r=t=>{let{Children:e}=t;return(0,c.jsx)("div",{children:e})}},9840:(t,e,a)=>{a.d(e,{e:()=>o});var c=a(9780),r=a(8524);const o=async t=>{const e=new FormData;e.append("image",t);const a=localStorage.getItem("token"),o={headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(a)},withCredentials:!0};try{const t=await c.c.post("".concat(r.M,"/api/upload-image/"),e,o);if(200===t.status){const e="".concat(r.M)+t.data.image_url;return alert("Image uploaded successfully"),e}alert("Failed to upload image")}catch(l){throw alert("Error uploading image:",l),new Error("Image upload failed")}}},6776:(t,e,a)=>{a.d(e,{Cg:()=>h,Ub:()=>f,Wh:()=>u,YH:()=>x,e6:()=>i,ew:()=>g,gn:()=>m,m8:()=>p,my:()=>d,yU:()=>y});var c=a(9780),r=a(4348),o=a(8524);const l=localStorage.getItem("token")?localStorage.getItem("token"):null,s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(l)},withCredentials:!0},n={headers:{"Content-type":"application/json"}},i=t=>async e=>{try{e({type:r.S});const{data:a}=await c.c.post("".concat(o.M,"/api/story/create/"),t,s);e({type:r.eY,payload:a})}catch(a){e({type:r.gf,payload:a})}},p=()=>async t=>{try{t({type:r.S_});const e=localStorage.getItem("token")?localStorage.getItem("token"):null,a={headers:{"Content-type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}},withCredentials:!0},{data:l}=await c.c.get("".concat(o.M,"/api/story/list"),a);t({type:r.gr,payload:l})}catch(e){t({type:r.cW,payload:e})}},d=t=>async e=>{try{e({type:r.wp});const{data:a}=await c.c.get("".concat(o.M,"/api/story/").concat(t),n);e({type:r.sT,payload:a})}catch(a){e({type:r.Sw,payload:a})}},y=(t,e)=>async a=>{try{a({type:r.SY});const{data:l}=await c.c.post("".concat(o.M,"/api/story/").concat(t,"/chapter/create/"),e,s);a({type:r.wb,payload:l})}catch(l){a({type:r.ol,payload:l})}},u=t=>async e=>{try{e({type:r.UJ});const{data:a}=await c.c.get("".concat(o.M,"/api/story/").concat(t,"/chapter/list"),n);e({type:r.i3,payload:a})}catch(a){e({type:r.U6,payload:a})}},h=(t,e)=>async a=>{try{a({type:r.Ws});const{data:l}=await c.c.get("".concat(o.M,"/api/story/").concat(t,"/chapter/").concat(e),n);a({type:r.Mn,payload:l})}catch(l){a({type:r.WG,payload:l})}},m=()=>async t=>{try{t({type:r.Ah});const{data:e}=await c.c.get("".concat(o.M,"/api/admin/story/list"),s);t({type:r.I1,payload:e})}catch(e){t({type:r.S6,payload:e})}},g=t=>async e=>{try{e({type:r.cX});const{data:a}=await c.c.get("".concat(o.M,"/api/admin/story/").concat(t,"/chapter/list"),s);e({type:r._I,payload:a})}catch(a){e({type:r.kf,payload:a})}},x=(t,e,a)=>async l=>{try{console.log(a),l({type:r.aA});const{data:n}=await c.c.put("".concat(o.M,"/api/story/").concat(t,"/chapter/").concat(e,"/update"),a,s);l({type:r.IT,payload:n})}catch(n){l({type:r.We,payload:n})}},f=(t,e)=>async a=>{try{console.log(e),a({type:r.m8});const{data:l}=await c.c.put("".concat(o.M,"/api/story/").concat(t,"/update"),e,s);a({type:r.Ip,payload:l})}catch(l){a({type:r.An,payload:l})}}},8536:(t,e,a)=>{a.r(e),a.d(e,{default:()=>h});var c=a(9060),r=a(624),o=a(1560),l=a(9840),s=a(6776),n=a(3120),i=a(9072),p=a(2432),d=a(4348),y=a(1784),u=a(2496);const h=t=>{let{dispatch:e}=t;const{storyid:a,chapterid:h}=(0,o.W4)(),[m,g]=(0,c.useState)(""),[x,f]=(0,c.useState)(!1),w=(0,r.w1)((t=>t.readChapter)),{loading:v,error:b,chapter:j}=w,C=(0,r.w1)((t=>t.updateChapter)),{loading:N,success:S}=C,M=(0,c.useRef)(null),k=(0,c.useRef)(null),I=(0,c.useRef)(null),W=(0,o.i6)(),[_,A]=(0,c.useState)({});(0,c.useEffect)((()=>{j&&j._id==h||e((0,s.Cg)(a,h));j&&j._id==h&&!x&&((async()=>{j&&j._id==h&&!x&&(M.current.value=j.title||"",k.current.value=j.chapter||"",I.current.value=j.summary||"",g(j.cover||"")),f(!0)})(),A({title:j.title,chapter:k.current.value,summary:I.current.value,cover:j.cover}))}),[e,a,h,null===j||void 0===j?void 0:j._id]);(0,c.useEffect)((()=>{S&&(alert("Chapter Updated ..."),W("/add/story/".concat(a)),e({type:d.GO}),e({type:d.AH}))}),[S]);return v?(0,u.jsx)(n.c,{}):b?(0,u.jsx)(i.c,{children:b}):j._id?(0,u.jsxs)("form",{onSubmit:t=>{t.preventDefault();const c={};M.current.value!==_.title&&(c.title=M.current.value),k.current.value!==_.chapter&&(c.chapter=k.current.value),I.current.value!==_.summary&&(c.summary=I.current.value),m!==_.cover&&(console.log("image",m),console.log("old img",_.image),c.cover=m),e((0,s.YH)(a,h,c))},className:"form bg-white p-6 my-10 relative max-w-lg mx-auto shadow-lg rounded-lg",children:[N&&(0,u.jsx)(p.c,{}),(0,u.jsx)(y.c,{url:"/list-story"}),(0,u.jsx)("h3",{className:"text-2xl text-gray-900 font-semibold",children:"Edit Chapter"}),(0,u.jsx)("div",{className:"flex space-x-5 mt-3",children:(0,u.jsx)("input",{type:"text",placeholder:"Title",className:"border p-2 w-1/2",ref:M})}),(0,u.jsx)("div",{className:"relative max-h-52 aspect-[9/16] bg-gray-200 overflow-hidden left-1/3 align-middle",children:(0,u.jsx)("img",{src:m,alt:"",className:"object-cover w-full h-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})}),(0,u.jsx)("div",{className:"flex space-x-5 mt-3",children:(0,u.jsx)("input",{type:"file",onChange:async t=>{t.preventDefault();const e=t.target.files[0];if(e)try{const t=await(0,l.e)(e);g(t)}catch(b){console.error("Image upload failed",b)}},className:"border p-2 w-1/2",accept:"image/*"})}),(0,u.jsx)("h1",{children:"Summary"}),(0,u.jsx)("textarea",{placeholder:"Write Summary here",className:"border p-2 mt-3 w-full",ref:I,maxLength:1e3}),(0,u.jsx)("h1",{children:"Chapter Content"}),(0,u.jsx)("textarea",{placeholder:"Write Chapter here",className:"border p-2 mt-3 w-full",ref:k,maxLength:5e3}),(0,u.jsx)("input",{type:"submit",value:"Update Chapter",className:"w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white font-semibold p-3"})]}):null}}}]);
//# sourceMappingURL=536.aebebf2e.chunk.js.cb5f37cf1d32.map